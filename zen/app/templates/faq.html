{% extends "base.html" %}

{%- block title %}
<title>Frequently asked questions</title>
{%- endblock title %}

{%- block nav %}
<li class="nav-item">
	<a class="nav-link" href="/">Home</a>
</li>
<li class="nav-item active">
	<a class="nav-link disabled" href="/faq">FAQ<span class="sr-only">(current)</span></a>
</li>
{%- endblock nav %}

{%- block body %}
{%- set tph = 3600/(info.blocktime * info.delegate)*info.blockreward %}

<div class="container">
	<h1>FAQ</h1>
<div class="alert alert-info"><strong>How does vote-reward work&nbsp;?</strong></div>
<p>
Voting for a delegate helps to push it within the top {{ info.delegate }} to be
allowed to forge blocks. Then, its associated node can puts transactions
in a block, signs it and inserts it into the blockchain. For each forged block,
the delegate wallet receives {{ "%d"%info.blockreward }}&nbsp;{{ info.symbol | safe }}
plus the fees of forged transaction(s).
</p>
<p>
The one runing this delegate may decide to share his reward to his voters. The
most common way is to distribute rewards according to individual vote weight.
</p>
<p>
Here, the share is computed and distributed according to vote weight each
time a block is forged. It is the True Block Weight mechanism.
</p>

<div class="alert alert-info"><strong>How much may I get&nbsp;?</strong></div>
<p>
Within {{ info.network }} network, block delay is {{ info.blocktime }}&nbsp;seconds.
A delegate forges a block every {{ info.blocktime * info.delegate }} seconds
that makes {{  _currency(tph) }} per hour. So on a daily basis, the maximum a
delegate could distribute is {{  _currency(tph*24) }}.
Important thing to notify here is that your vote weight might fluctuate between
two forged block according to total vote variation.
</p>
{%- for username in delegates %}
<div class="form-column" style="padding:20px;padding-top:0px;">
<span class="input-group input-group-sm">
	<div class="input-group-prepend">
		<span class="input-group-text">
			<input id="voted_{{ username }}" type="checkbox" 
			       title="Select if you already up voted {{ username }}"
			       onclick="computeReward('{{ username }}', {{ delegates[username].votes }}, {{ tph*24 }})" />
		</span>
		<span class="input-group-text">{{ username }}</span>
	</div>
	<input id="vote_{{ username }}" type="number" class="form-control" placeholder="Wallet balance" 
	       onkeyup="computeReward('{{ username }}', {{ delegates[username].votes }}, {{ tph*24 }})"/>
	<input id="estimate_{{ username }}" readonly type="number" class="form-control" placeholder="Estimated share" />
	<div class="input-group-append">
		<span class="input-group-text">{{ info.symbol | safe }}/day</span>
	</div>
</span>
</div>
{%- endfor %}

<div class="alert alert-info"><strong>Can I withdraw part of my voting wallet&nbsp;?</strong></div>
<p>
Yes. Because sometime it is interesting to trade {{ info.symbol | safe }}, it is
allowed to withdraw part of the wallet but your relative vote weight will decrease.
<ul class="alert-warning">
{%- for username in delegates %}
<li>If you voted for {{ username }}
{%- if delegates[username].minimum_vote %}
you will have to keep a minimum of {{ _currency(delegates[username].minimum_vote) }}.</li>
{%- else %}
you will have to keep a minimum of {{ _currency(1) }}.</li>
{%- endif %}
{%- endfor %}
</ul>
</p>

<div class="alert alert-info"><strong>Do I need to register somewhere&nbsp;?</strong></div>
<p>
No. You only have to vote for the delegate using
<a href="https://docs.ark.io/tutorials/usage-guides/how-to-use-ark-desktop-wallet.html#voting-for-a-registered-delegate-and-unvoting" target="_">Ark Desktop Wallet</a>.
<ul class="alert-warning">
{%- for username in delegates %}
{%- if delegates[username].minimum_vote %}
<li>
If you voted for {{ username }} you will need a minimum of
{{ _currency(delegates[username].minimum_vote) }}.
</li>
{%- endif %}
{%- endfor %}
</ul>
</p>

<div class="alert alert-info"><strong>Will I get my pending reward if I down vote delegate&nbsp;?</strong></div>
<p>
No. Once the delegate is down voted, the undistributed share is redistributed to
the other voters.
</p>
</div>

<script>
function computeReward(username, totalvote, daily_forged){
	var balance = parseInt(document.getElementById("vote_"+username).value);
	totalvote += document.getElementById("voted_"+username).checked?0:balance;
	var ratio = 1.0 * balance / totalvote;
	var share = ratio*daily_forged;
	document.getElementById("estimate_"+username).value = share>0?(share).toFixed(8):"";
}
</script>
{%- endblock body %}
